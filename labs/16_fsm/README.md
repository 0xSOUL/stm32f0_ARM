## Задание 16 "fsm"

В этом задании вам предлагается написать конечный автомат на примере простой задачи. Необходимо реализовать программу, которая при нажатии кнопки:
1. Включает светодиод PC8, если PC8 и PC9 выключены.
2. Включает светодиод PC9 и выключает светодиод PC8, если PC8 включен, а PC9 выключен.
3. Выключает оба светодиода, если PC9 включен, а PC8 выключен.

Это можно изобразить в виде схемы: 
![Image alt](https://github.com/edosedgar/stm32f0_ARM/raw/master/labs/16_fsm/gt1.png)

Каждая стрелка данной схемы означает, что прозошло событие (в нашем случае - кнопка была нажата). Вершины означают конечные состояния машины. В проекте выше вы можете видеть реализацию конечного автомата. Он отличается от нашего тем, что имеет лишь два состояния, а не три.  (Работает только один светодиод). В файле `fsm.h`, находящемся в папке `lib`, прописаны функции и перечисления, которыми оперирует программа: 

```c
enum FSM_STATES {
    STARTUP = 0,
    BUTTON_POLL,
    LED_TURN_ON 
};
```
- состояния машины
```c
enum RET_CODES {
    OK_FSM = 0,
    ERROR_FSM,
    REPEAT_FSM
};
```
- все возможные коды возврата для каждого состояния
```c
typedef struct {
    enum FSM_STATES src_state;
    enum RET_CODES ret_code;
    enum FSM_STATES dst_state;
} fsm_cell_t;
```
- структура таблицы переходов между состояниями
```c
void fsm_loop(enum FSM_STATES init_state);
```
- функция запуска машины
```c
enum RET_CODES do_startup(void);
enum RET_CODES do_button_poll(void);
enum RET_CODES do_led_turn(void);
```
- функции первичного состояния, опроса кнопки, переключения светодиода.

В файле `fsm.c` описана работа этих функций. В файле `main` происходит только настройка системы тактирования и запуск машины.







