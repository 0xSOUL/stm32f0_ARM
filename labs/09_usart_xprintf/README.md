## Задание 09 "usart_xprintf"

В этом задании вам предлагается познакомится с библиотекой xprintf. 
Эта библиотека позволяет производить вывод с произвольным поведением, 
использую функции схожие с функциями ввода-вывода из libc.

### Инициализация периферии

Инициализация USART практически полностью совпадает с [предыдущим заданием](https://github.com/leokondrashov/stm32f0_ARM/tree/master/labs/09_usart_terminal).

За исключением того, что в данной работе нам не нужны прерывания, поэтому мы их не включаем.

### Работа с библиотекой

Всё начинается с инициализации: первым делом происходит инициализация функций, которые библиотека будет использовать:


```c
static char usart_getc(void) // Ввод
{
    while (!(LL_USART_IsActiveFlag_RXNE(USART1)));
    return LL_USART_ReceiveData8(USART1);
}

static void usart_putc(char symbol) // Вывод
{
    while (!LL_USART_IsActiveFlag_TXE(USART1));
    LL_USART_TransmitData8(USART1, symbol);
    while (!LL_USART_IsActiveFlag_TC(USART1));
}

/*
 * Set callback for out device
 */
static void printf_config(void)
{
    xdev_out(usart_putc);
    xdev_in(usart_getc);
    return;
}

```

В функциях `usart_getc` и `usart_putc` обращаемся к USART за новым байтом (если его нет, то ждём, когда появится), либо ожидаем готовности на передачу и передаём нужный нам символ.

Эти функции библиотека будет использовать для вывода и ввода при вызове соответствующих функций. Например, при вызове `xprintf`, в нашем случае, библиотека будет вызывать для каждого символа, который ей надо вывести, функцию `usart_putc`.

На самом деле, можно задать произвольное поведение для ввода и вывода, передав нужные функции в библиотеку (например, использовать другой интерфейс, реализовать в функции вывода мигание светодиодом азбукой Морзе нужного символа).

### Дополнительные задания

В качестве дополнительного задания можно сделать терминал ([см. предыдущую работу](https://github.com/leokondrashov/stm32f0_ARM/tree/master/labs/09_usart_terminal)), но теперь команды и ответы должны быть текстовыми, что можно будет использовать в интерактивном режиме, подключившись к USART с компьютера через последовательный терминал (например, PuTTY).
